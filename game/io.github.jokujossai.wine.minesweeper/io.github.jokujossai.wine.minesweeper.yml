id: io.github.jokujossai.wine.minesweeper
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
base: io.github.jokujossai.wine.base
base-version: '25.08'

command: entrypoint.sh

inherit-extensions:
  - org.freedesktop.Platform.Compat.i386
  - org.freedesktop.Platform.Compat.i386.Debug
  - org.freedesktop.Platform.GL32
  - org.freedesktop.Platform.GL32.Debug
  - org.freedesktop.Platform.VAAPI.Intel.i386
  - org.freedesktop.Platform.VAAPI.nvidia.i386
  - org.freedesktop.Platform.codecs_extra.i386
  - io.github.jokujossai.wine.gecko
  - io.github.jokujossai.wine.mono
  - io.github.jokujossai.gamescope
  - io.github.jokujossai.wine.Version

finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --socket=pulseaudio
  - --allow=multiarch
  - --device=dri
  - --env=WINEARCH=win32
  - --env=WINEPREFIX=/var/data/wine
  - --env=GST_PLUGIN_SYSTEM_PATH=/app/lib/gstreamer-1.0:/app/lib32/gstreamer-1.0:/usr/lib/extensions/gstreamer-1.0:/usr/lib/x86_64-linux-gnu/codecs-extra/lib/gstreamer-1.0:/usr/lib/i386-linux-gnu/codecs-extra/lib/gstreamer-1.0:/usr/lib/x86_64-linux-gnu/gstreamer-1.0:/usr/lib/i386-linux-gnu/gstreamer-1.0

modules:
  # Minesweeper game files
  - name: minesweeper
    buildsystem: simple
    build-commands:
      - install -Dm644 winmine.exe /app/share/minesweeper/winmine.exe
      - install -Dm644 config.ini /app/config.ini
      - install -Dm644 io.github.jokujossai.wine.minesweeper.desktop /app/share/applications/io.github.jokujossai.wine.minesweeper.desktop
      - install -Dm644 io.github.jokujossai.wine.minesweeper.metainfo.xml /app/share/metainfo/io.github.jokujossai.wine.minesweeper.metainfo.xml
      - install -Dm644 icon.png /app/share/icons/hicolor/128x128/apps/io.github.jokujossai.wine.minesweeper.png
      - install -Dm755 wine-backup.sh /app/bin/wine-backup.sh
      - install -Dm755 wine-restore.sh /app/bin/wine-restore.sh
    sources:
      # Minesweeper executable (from Windows XP via archive.org)
      - type: file
        url: https://archive.org/download/winmine_xp/WINMINE.EXE
        sha256: bcff89311d792f6428468e813ac6929a346a979f907071c302f418d128eaaf41
        dest-filename: winmine.exe

      - type: file
        path: config.ini

      - type: file
        path: io.github.jokujossai.wine.minesweeper.desktop

      - type: file
        path: io.github.jokujossai.wine.minesweeper.metainfo.xml

      - type: file
        path: icon.png

      - type: file
        path: wine-backup.sh

      - type: file
        path: wine-restore.sh
