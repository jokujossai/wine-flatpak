name: libinput
buildsystem: meson
config-opts:
  - --libexec=lib
  - -Dlibwacom=false
  - -Ddebug-gui=false
  - -Dtests=false
  - -Ddocumentation=false
  - -Dzshcompletiondir=no
sources:
  - type: archive
    url: https://gitlab.freedesktop.org/libinput/libinput/-/archive/1.30.1/libinput-1.30.1.tar.gz
    sha256: 4339a2b9cc96ede3c120dedaedc61e48ce567808c5229e66587525ea972ef617
    x-checker-data:
      type: git
      url: https://gitlab.freedesktop.org/libinput/libinput.git
      tag-pattern: ^([\d.]+)$
      url-template: https://gitlab.freedesktop.org/libinput/libinput/-/archive/$version/libinput-$version.tar.gz
cleanup:
  - /bin
  - /etc
  - /lib/libinput
  - /lib/udev
  - /share
  - /include
  - /lib/pkgconfig
modules:
  - name: mtdev
    buildsystem: autotools
    config-opts:
      - --disable-static
    sources:
      - type: archive
        url: https://bitmath.org/code/mtdev/mtdev-1.1.7.tar.bz2
        sha256: a107adad2101fecac54ac7f9f0e0a0dd155d954193da55c2340c97f2ff1d814e
        x-checker-data:
          type: html
          url: https://bitmath.org/code/mtdev/
          version-pattern: mtdev-([\d.]+)\.tar\.bz2
          url-template: https://bitmath.org/code/mtdev/mtdev-$version.tar.bz2
      # Upstream uses an outdated version of the config.guess/config.sub script,
      # so we override it here to fix aarch64 builds.
      - type: shell
        commands:
          - cp -p /usr/share/automake-*/config.{sub,guess} config-aux/
    cleanup:
      - /bin
      - /include
      - /lib/*.la
      - /lib/pkgconfig