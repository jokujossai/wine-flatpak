id: io.github.jokujossai.wine.Version.wine-9-wow64
branch: '25.08'
runtime: io.github.jokujossai.wine.base
runtime-version: '25.08'
sdk: org.freedesktop.Sdk//25.08
build-extension: true
separate-locales: false
appstream-compose: false

sdk-extensions:
  - org.freedesktop.Sdk.Extension.mingw-w64

build-options:
  prefix: /app/wine/wine-9-wow64
  prepend-path: /app/wine/wine-9-wow64/bin
  append-path: /usr/lib/sdk/mingw-w64/bin
  cflags: -std=gnu17
  cxxflags: -std=gnu++17
  config-opts:
    - CROSSCFLAGS=-std=gnu17

modules:

  # Wine (WoW64 unified build)

  - name: wine
    config-opts:
      - --enable-archs=i386,x86_64
      - --disable-tests
      - --with-x
      - --with-pulse
      - --with-dbus
      - --without-hal
      - --without-oss
    make-install-args:
      - LDCONFIG=/bin/true
      - UPDATE_DESKTOP_DATABASE=/bin/true
      - INSTALL_PROGRAM_FLAGS=-s
    post-install:
      - ln -sf /app/share/wine/gecko ${FLATPAK_DEST}/share/wine/gecko
      - ln -sf /app/share/wine/mono ${FLATPAK_DEST}/share/wine/mono
    sources:
      - type: archive
        url: https://dl.winehq.org/wine/source/9.x/wine-9.22.tar.xz
        sha256: e150d29742aa54f768ef3e976ed861aaa4f9f48542e409bea902d0f49b359683
        x-addons-url: >-
          https://gitlab.winehq.org/wine/wine/-/raw/master/dlls/appwiz.cpl/addons.c
        x-checker-data:
          type: html
          url: https://dl.winehq.org/wine/source/9.x/
          version-pattern: wine-(\d+\.[\d.]+)\.tar\.xz
          url-template: https://dl.winehq.org/wine/source/9.x/wine-$version.tar.xz
          versions:
            <: '10.0'
          is-main-source: true

  # Tools

  - ../modules/winetricks.yml
